---
layout: default
---

# 企画開発部 プログラミング勉強会第三回


## 目次

- [配列](#配列)
- [std::vector](#std::vector)
- [std::string](#std::string)
- [関数](#関数)
- [スコープ](#スコープ)

## イントロ

今回はまず、複数のデータをまとめて扱うことができる「配列」を紹介します。

`C`や`C++`では配列の一般的な仕様として、`int A[4]`みたいに変数名の後ろに`[]`をつけて中に要素数を指定するものがあります。
- prog0で確実に習うと思うのでそちらに任せます

今回の勉強会ではそれを**扱わず**`C++`の標準ライブラリのひとつ`std::vector`(可変長配列)で同等の処理の方法を学んでいただきます。
- こうする理由は、`Siv3D`で配列として提供されている`s3d::Array`が`std::vector`と使い方が似ているためです。

また、文字列を扱う「`std::string`」も紹介します。`std::vector`とほぼ使い方が同じです。

次に今回の目玉、「関数」を扱います。

関数では、重複する処理等を`main`関数から分割して扱うことができます。
- ロジックを上手く分割して、関数に分けて記述することはプログラミングの醍醐味の一つであり、楽しく感じる人も多いでしょう

関数は大事な概念なので、 $2$ 回に分けて勉強会を行います。今回はその前半として、スコープを扱います。

スコープとは、簡単に言えば「変数の生きていられる範囲」です

`if`、文や`for`文、関数が存在するプログラムを書いたり読んだりするためにはスコープの理解が必須です。

今回も盛りだくさんですが、気張っていきましょう！


## 配列

唐突に質問ですが、「Excel」をご存知ですか？「Excel」は表計算ソフトの一つですね。

Excelを開くと表がずらーっとでてきて、そこに数やテキストを入れることができます。
- 行番号と列番号 $(i, j)$ に対してデータを一つ割り当てるわけですね。

`C`や`C++`でも似たようなことができたら嬉しいですよね。

例えば、あなたが学校の先生で、生徒のテストの点数を管理することを考えます。
- 平均点、中央値を出したり
- 各生徒毎に偏差値を割り出したりしたいです

そのような時に第一回、第二回勉強会で習った概念のみでプログラムを書こうとするとこうなります。

```cpp
#include <iostream>

int main() {
    int p1 = 50, p2 = 80, p3 = 78, p4 = 32, p5 = 100, p6 = 68, p7 = 26;
    double ave = (p1 + p2 + p3 + p4 + p5 + p6 + p7) / 7;
    ...
}
```

正直平均点だけでもかなり厳しいですね。中央値を求めようとすると、 $7$ 要素を昇順に並び替える必要があるので、それはそれはもうすごい`if`文祭りになっていしまいます。

しかも実際は、生徒は $30$ 人くらいいます。絶望....

しかし、`C`、`C++`を含む多くのプログラミング言語では、このような複数のデータを扱う方法の一つに「配列」を提供しています。

`C++`ではメジャーなものに $4$ 種類の配列があります。

- 生配列(いわゆる「普通の配列」)
- `std::array` (固定長配列)
- `std::vector` (可変長配列)
- `std::unique_ptr<T[]>` (自分が馴染み無いので説明は避けます)

今回は $3$ 番目の`std::vector`を重点的に説明します。

## std::vector

```cpp
#include <iostream>
#include <vector> // std::vectorを利用するにはこのヘッダをインクルードする必要がある

int main() {
    std::vector<int> A = { 1, 4, 5, 6, 2 };
    std::cout << A[0] << std::endl; // 1番目の要素「1」が出力される
    std::cout << A[2] << std::endl; // 3番目の要素「5」が出力される
    std::cout << A.size() << std::endl; // Aの要素数「5」が出力される
    std::cout << A.back() << std::endl; // Aの最後の要素「2」が出力される
    A[1] += 3; // Aの2番目の要素に3を足す
    std::cout << A[1] << std::endl; // 7が出力される
    return 0;
}
```

例えば、上のサンプルコードの例だと $(1, 4, 5, 6, 2)$ という整数の列を`std::vector`で扱っています。
- 各要素を出力したり、要素数を出力したり、要素に値を加算したりしていますね。

`std::vector`を扱うには色々ポイントがあります。ひとつひとつ見ていきましょう
- すべてを覚える必要はありません。必要に応じて調べながら使ってみてください
- リファレンスの日本語訳は[こちら](https://cpprefjp.github.io/reference/vector/vector.html)です

```cpp
#include <vector>
```

標準入出力を行うのに`#include <iostream>`をしたのと同様に、`vector`というヘッダをインクルードする必要があります。

```cpp
std::vector<int> A = { 1, 4, 5, 6, 2 };
```
`std::vector<扱いたい型> 変数名 = { 列の要素をカンマ区切り }`とすることで`std::vector`を宣言、初期化することができます。

他にも様々な初期化(第4回の内容になりますが、正しく言うとコンストラクタ)があります。
- 扱いたい型を`int`にした場合で例示しておきます。

| A | 空列で初期化する |
| A(5) | 長さ $5$ の各要素が $0$ の列 |
| A(3, 1) | 長さ $3$ の各要素が $1$ の列 |
| A = { 1, 2, 3, 4, 5 } | 列(1, 2, 3, 4, 5) |
| A(B) | (Bという`std::vector<int>`がある状態で)Bのコピー |
| A = B | (Bという`std::vector<int>`がある状態で)Bのコピー |

```cpp
A[0]
```

各要素にアクセスするには、`変数名[番号]`とします。
- この番号を添字と言ったりします
- 添字は、 $0$ からスタートすることに注意してください

ここで、列の範囲外の添字を指定したりするとプログラムがどのような動作をするかわかりません
- 実行時エラーを吐いたり、吐かなかったりします。

```cpp
A.size()
```

変数名`.size()`とすることで、列の要素数を取得することができます。

この`.OOO()`をメンバ関数と呼びます。詳しくは次回やります。`std::vector`のメンバ関数をいくつか紹介しておきます。

| 呼び出し方 | できること | ()の中に入れるもの | 注釈 |
| A.size() | 要素数を取得する | 何も入れない | 要素数を扱う型はint型では無く`std::size_t`型 |
| A.front() | 一番最初の要素を取得する | 何も入れない | A[0]と同じ |
| A.back() | 一番最後の要素を取得する | 何も入れない | A[A.size() - 1]と同じ |
| A.at(i) | (i + 1)番目の要素を取得する | 取得したい要素の番号 | 範囲外アクセスをすると例外を出す(大雑把に言うと、エラーにしてくれる) |
| A.clear() | 全要素を削除する | 何も入れない | 呼び出し後、空になる |

#### std::vectorとfor文は相性が良い
